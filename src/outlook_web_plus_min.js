"use strict";let startTimer=null,hideLeftRail=!0,hidePremiumAd=!0,hideTopIcons=!0,hideFirstemailAd=!0,emailsText="emails",premiumLogo=!1,currentTitle=document.title,addNumberOfEmail=!0,numberOfEmailColor="green",checkAllVisible=!0,alignTitle=!0,addcustomBackground=!0,customBackground="https://wallpapercave.com/wp/wp2757894.gif",topbarTransparency=!0,supportAndRateButton=!0;const start=async()=>{if(null!==document.getElementById("o365header")){let e=await new Promise(e=>{chrome.storage.local.get(null,t=>e(t))});loadVariables(e),clearInterval(startTimer),await Promise.all([cleanLeftRail(),updatePremiumLogo(),titleListener(),cleanFirstmailAd(),cleanPremiumAd(),cleanTopIcons(),mailCalculator(),selectAll(),checkAll(),alignFolderTitle(),addButtonClickListeners(),backgroundChanger(),topbarTransparencyChanger(),addSupportAndRate()])}};startTimer=setInterval(start,200),chrome.storage.onChanged.addListener(function(e){let t=Object.keys(e)[0];switch(t){case"hideLeftRail":hideLeftRail=e.hideLeftRail.newValue,cleanLeftRail(0);break;case"hidePremiumAd":hidePremiumAd=e.hidePremiumAd.newValue,cleanPremiumAd(0);break;case"hideTopIcons":hideTopIcons=e.hideTopIcons.newValue,cleanTopIcons(0);break;case"premiumLogo":premiumLogo=e.premiumLogo.newValue,updatePremiumLogo(0),titleListener(0);break;case"hideFirstemailAd":hideFirstemailAd=e.hideFirstemailAd.newValue,cleanFirstmailAd(0);break;case"addNumberOfEmail":addNumberOfEmail=e.addNumberOfEmail.newValue,mailCalculator(0);break;case"numberOfEmailColor":numberOfEmailColor=e.numberOfEmailColor.newValue,mailCalculator(0);break;case"checkAllVisible":checkAllVisible=e.checkAllVisible.newValue,checkAll(0);break;case"alignTitle":alignTitle=e.alignTitle.newValue,alignFolderTitle(0);break;case"addcustomBackground":addcustomBackground=e.addcustomBackground.newValue,backgroundChanger(0);break;case"customBackground":customBackground=e.customBackground.newValue,backgroundChanger(0);break;case"topbarTransparency":topbarTransparency=e.topbarTransparency.newValue,topbarTransparencyChanger(0);break;case"supportAndRateButton":supportAndRateButton=e.supportAndRateButton.newValue,addSupportAndRate(0)}});const loadVariables=e=>{hideFirstemailAd=void 0===e.hideFirstemailAd?hideFirstemailAd:e.hideFirstemailAd,hideLeftRail=void 0===e.hideLeftRail?hideLeftRail:e.hideLeftRail,hidePremiumAd=void 0===e.hidePremiumAd?hidePremiumAd:e.hidePremiumAd,hideTopIcons=void 0===e.hideTopIcons?hideTopIcons:e.hideTopIcons,premiumLogo=void 0===e.premiumLogo?premiumLogo:e.premiumLogo,addNumberOfEmail=void 0===e.addNumberOfEmail?addNumberOfEmail:e.addNumberOfEmail,checkAllVisible=void 0===e.checkAllVisible?checkAllVisible:e.checkAllVisible,alignTitle=void 0===e.alignTitle?alignTitle:e.alignTitle,addcustomBackground=void 0===e.addcustomBackground?addcustomBackground:e.addcustomBackground,customBackground=void 0===e.customBackground?customBackground:e.customBackground,topbarTransparency=void 0===e.topbarTransparency?topbarTransparency:e.topbarTransparency,supportAndRateButton=void 0===e.supportAndRateButton?supportAndRateButton:e.supportAndRateButton,"string"==typeof e.numberOfEmailColor&&(numberOfEmailColor=e.numberOfEmailColor),chrome.storage.local.set({hideLeftRail,hidePremiumAd,hideFirstemailAd,hideTopIcons,premiumLogo,addNumberOfEmail,numberOfEmailColor,checkAllVisible,alignTitle,addcustomBackground,customBackground,topbarTransparency,supportAndRateButton})},titleListener=(e=100)=>{let t=document.getElementById("owaTimePanelBtn_container");t.addEventListener("click",()=>{let t=()=>{let e=document.querySelector('button[title="Open Calendar"]');e&&(e.addEventListener("click",()=>{l()}),clearInterval(a))},a=setInterval(t,e)});let l=()=>{document.title!==currentTitle&&(currentTitle=document.title,premiumLogo&&!currentTitle.endsWith("+")&&(currentTitle+="+",document.title=currentTitle)),clearInterval(a)},a=setInterval(l,e)},updatePremiumLogo=(e=100)=>{let t=()=>{let e=document.getElementById("O365_AppName");if(e){let t=e.querySelector("span");t&&premiumLogo?(t.innerHTML="Outlook+",t.style.background="linear-gradient(110deg, rgb(20, 144, 223), rgb(40, 168, 234), rgb(156, 206, 231), rgb(40, 168, 234), rgb(20, 144, 223)",t.style.backgroundSize="200% 100%",t.style.backgroundClip="text",t.style.color="transparent",t.style.animation="shiny 5s linear infinite",t.style.fontSize="16px",t.animate([{backgroundPosition:"-100% 0"},{backgroundPosition:"100% 0"}],{duration:6e3,iterations:1/0})):(t.innerHTML="Outlook",t.style=""),clearInterval(l)}},l=setInterval(t,e)},mailCalculator=(e=150)=>{let t=()=>{let e=document.querySelector(".jXaVF");if(e){let t=e.innerText,a=document.querySelector(".hcptT"),i=a?a.getAttribute("aria-setsize"):0,r=RegExp(`\\s\\(${i} ${emailsText}\\)`);r.test(t)?e.innerHTML=t.replace(r,`<b class="mailColor" style="color: ${numberOfEmailColor}; display: ${addNumberOfEmail?"inline":"none"}"> (${i} ${emailsText})</b>`):e.innerHTML=`${t} <b class="mailColor" style="color: ${numberOfEmailColor}; display: ${addNumberOfEmail?"inline":"none"}"> (${i} ${emailsText})</b>`,clearInterval(l)}},l=setInterval(t,e)},cleanLeftRail=()=>{let e=document.getElementById("LeftRail");e.style.display=hideLeftRail?"none":"block"},cleanPremiumAd=(e=100)=>{let t=()=>{let e=document.querySelector(".Ogqyq");e&&(e.style.display=hidePremiumAd?"none":"block",clearInterval(l))},l=setInterval(t,e)},alignFolderTitle=(e=100)=>{let t=()=>{let e=document.querySelector(".IG8s8");e&&(alignTitle?e.style.paddingLeft="0px":e.style.paddingLeft="16px",clearInterval(l))},l=setInterval(t,e)},cleanTopIcons=(e=100)=>{let t=()=>{let e=document.getElementById("headerButtonsRegionId").children;e.length>=7&&(document.getElementById("owaMeetNowButton_container").style.display=hideTopIcons?"none":"block",document.getElementById("teams_container").style.display=hideTopIcons?"none":"block",document.getElementById("owaNoteFeedButton_container").style.display=hideTopIcons?"none":"block",clearInterval(l))},l=setInterval(t,e)},cleanFirstmailAd=(e=100)=>{let t=0,l=()=>{let e=document.getElementById("OwaContainer");if(e){let l=document.querySelector('i[title="Remove"]');e.style.display=hideFirstemailAd?"none":"block",l&&setTimeout(l.click(),200),clearInterval(a)}t>=60&&clearInterval(a),t++},a=setInterval(l,e)},checkAll=(e=100)=>{let t=()=>{let e=document.querySelector(".rk2CU");e&&(checkAllVisible?e.style.visibility="visible":e.style.visibility="hidden",clearInterval(l))},l=setInterval(t,e)},selectAll=(e=150)=>{let t=()=>{let e=document.querySelector(".rk2CU"),t=document.querySelectorAll(".d1dnN");e&&t&&(t.forEach(e=>{e.addEventListener("click",()=>{"true"===e.getAttribute("aria-checked")&&(setTimeout(alignFolderTitle,150),setTimeout(mailCalculator,150))})}),e.addEventListener("click",()=>{"true"===e.getAttribute("aria-checked")&&(setTimeout(alignFolderTitle,150),setTimeout(mailCalculator,150))}),clearInterval(l))},l=setInterval(t,e)},addButtonClickListeners=(e=150)=>{let t=()=>{let e=document.querySelectorAll(".C2IG3");e&&(e.forEach(e=>{e.addEventListener("click",()=>{setTimeout(checkAll,100),setTimeout(selectAll,100),setTimeout(alignFolderTitle,300),setTimeout(mailCalculator,300),setTimeout(cleanFirstmailAd,0);let e=document.querySelector('i[title="Remove"]');e&&setTimeout(e.click(),200)})}),clearInterval(l))},l=setInterval(t,e)},backgroundChanger=(e=150)=>{let t=()=>{let e=document.querySelector(".o365sx-navbar");e&&addcustomBackground&&(e.style.backgroundImage=`url("${customBackground}")`,e.style.backgroundPosition="center",e.style.backgroundRepeatX="repeat"),addcustomBackground||(e.style.backgroundImage=""),clearInterval(l)},l=setInterval(t,e)},topbarTransparencyChanger=(e=50)=>{let t=()=>{let e=document.querySelector(".o365sx-appName"),t=document.querySelectorAll(".o365sx-button"),a=document.querySelector(".nUPgy");if(e&&12==t.length&&a){let i=getComputedStyle(e),r=i.backgroundColor,o=n(r,topbarTransparency?0:.8);function n(e,t){let l=e.match(/#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})/i),a=e.match(/rgb\((\d+), (\d+), (\d+)\)/i),i=e.match(/rgba\((\d+), (\d+), (\d+), (0(\.\d+)?|1(\.0)?)\)/i);return a?`rgba(${a[1]}, ${a[2]}, ${a[3]}, ${t})`:i?`rgba(${i[1]}, ${i[2]}, ${i[3]}, ${t})`:l?`rgba(${parseInt(l[1],16)}, ${parseInt(l[2],16)}, ${parseInt(l[3],16)}, ${t})`:void 0}e.style.backgroundColor=o,a.style.backgroundColor=o,t.forEach(e=>{e.style.backgroundColor=o}),clearInterval(l)}},l=setInterval(t,e)},addSupportAndRate=(e=100)=>{let t=()=>{let e=document.getElementById("headerButtonsRegionId");if(e){if(supportAndRateButton&&"owaMeetNowButton_container"==e.firstChild.id){let t=document.createElement("div");t.id="rateAndSupport_container",t.classList.add("M3pcB5evSAtYMozck1WU7A=="),t.style.display="block";let a=document.createElement("a");a.style.width="48px",a.style.height="48px",a.style.display="flex",a.style.justifyContent="center",a.style.alignItems="center",a.href="https://addons.mozilla.org/fr/firefox/addon/outlook-web-plus/reviews/",a.target="_blank";let i=document.createElement("img");i.src="https://raw.githubusercontent.com/rztprog/outlook-web-plus/main/icons/stars_rating.png",a.appendChild(i),t.appendChild(a),e.insertBefore(t,e.firstChild)}else supportAndRateButton?e.firstChild.style.display="block":e.firstChild.style.display="none";clearInterval(l)}},l=setInterval(t,e)};