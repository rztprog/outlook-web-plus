"use strict";let startTimer=null,hideLeftRail=!0,hidePremiumAd=!0,hideTopIcons=!0,premiumLogo=!0,currentTitle=document.title,addNumberOfEmail=!0,numberOfEmailColor="green",checkAllVisible=!0,alignTitle=!0;const start=()=>{let e=document.getElementById("LeftRail");null!==e&&chrome.storage.local.get(null,function(e){loadVariables(e),clearInterval(startTimer),cleanLeftRail(),rootFolder(),updatePremiumLogo(),titleListener(),cleanMailPub(),cleanPremiumAd(),cleanTopIcons(),mailCalculator(),selectAll(),checkAll(),alignFolderTitle(),addButtonClickListeners()})};startTimer=setInterval(start,200),chrome.storage.onChanged.addListener(function(e){let l=Object.keys(e)[0];switch(l){case"hideLeftRail":hideLeftRail=e.hideLeftRail.newValue,cleanLeftRail();break;case"hidePremiumAd":hidePremiumAd=e.hidePremiumAd.newValue,cleanPremiumAd(0);break;case"hideTopIcons":hideTopIcons=e.hideTopIcons.newValue,cleanTopIcons(0);break;case"premiumLogo":premiumLogo=e.premiumLogo.newValue,updatePremiumLogo(0),titleListener();break;case"addNumberOfEmail":addNumberOfEmail=e.addNumberOfEmail.newValue,mailCalculator(0);break;case"numberOfEmailColor":numberOfEmailColor=e.numberOfEmailColor.newValue,mailCalculator(0);break;case"checkAllVisible":checkAllVisible=e.checkAllVisible.newValue,checkAll(0);break;case"alignTitle":alignTitle=e.alignTitle.newValue,alignFolderTitle(0)}});const loadVariables=e=>{hideLeftRail=void 0===e.hideLeftRail?hideLeftRail:e.hideLeftRail,hidePremiumAd=void 0===e.hidePremiumAd?hidePremiumAd:e.hidePremiumAd,hideTopIcons=void 0===e.hideTopIcons?hideTopIcons:e.hideTopIcons,premiumLogo=void 0===e.premiumLogo?premiumLogo:e.premiumLogo,addNumberOfEmail=void 0===e.addNumberOfEmail?addNumberOfEmail:e.addNumberOfEmail,checkAllVisible=void 0===e.checkAllVisible?checkAllVisible:e.checkAllVisible,alignTitle=void 0===e.alignTitle?alignTitle:e.alignTitle,"string"==typeof e.numberOfEmailColor&&(numberOfEmailColor=e.numberOfEmailColor),chrome.storage.local.set({hideLeftRail,hidePremiumAd,hideTopIcons,premiumLogo,addNumberOfEmail,numberOfEmailColor,checkAllVisible,alignTitle})},titleListener=(e=100)=>{let l=document.getElementById("owaTimePanelBtn_container");l.addEventListener("click",()=>{let l=()=>{let e=document.querySelector('button[title="Open Calendar"]');e&&(e.addEventListener("click",()=>{i()}),clearInterval(t))},t=setInterval(l,e)});let i=()=>{document.title!==currentTitle&&(currentTitle=document.title,premiumLogo&&!currentTitle.endsWith("+")&&(currentTitle+="+",document.title=currentTitle)),clearInterval(t)},t=setInterval(i,e)},updatePremiumLogo=(e=100)=>{let l=()=>{let e=document.getElementById("O365_AppName");if(e){let l=e.querySelector("span");l&&premiumLogo?(l.innerHTML="Outlook+",l.style.background="linear-gradient(110deg, rgb(20, 144, 223), rgb(40, 168, 234), rgb(156, 206, 231), rgb(40, 168, 234), rgb(20, 144, 223)",l.style.backgroundSize="200% 100%",l.style.backgroundClip="text",l.style.color="transparent",l.style.animation="shiny 5s linear infinite",l.style.fontSize="16px",l.animate([{backgroundPosition:"-100% 0"},{backgroundPosition:"100% 0"}],{duration:6e3,iterations:1/0})):(l.innerHTML="Outlook",l.style=""),clearInterval(i)}},i=setInterval(l,e)},mailCalculator=(e=150)=>{let l=()=>{let e=document.querySelector(".jXaVF");if(e){let l=e.innerText,t=document.querySelector(".hcptT"),a=t?t.getAttribute("aria-setsize"):0,r=/\s\(\d+ mails\)/;r.test(l)?e.innerHTML=l.replace(r,`<b class="mailColor" style="color: ${numberOfEmailColor}; display: ${addNumberOfEmail?"inline":"none"}"> (${a} mails)</b>`):e.innerHTML=`${l} <b class="mailColor" style="color: ${numberOfEmailColor}; display: ${addNumberOfEmail?"inline":"none"}"> (${a} mails)</b>`,clearInterval(i)}},i=setInterval(l,e)},cleanLeftRail=()=>{let e=document.getElementById("LeftRail");e.style.display=hideLeftRail?"none":"block"},cleanPremiumAd=(e=100)=>{let l=()=>{let e=document.querySelector(".Ogqyq");e&&(e.style.display=hidePremiumAd?"none":"block",clearInterval(i))},i=setInterval(l,e)},alignFolderTitle=(e=100)=>{let l=()=>{let e=document.querySelector(".IG8s8");e&&(alignTitle?e.style.paddingLeft="0px":e.style.paddingLeft="16px",clearInterval(i))},i=setInterval(l,e)},cleanTopIcons=(e=100)=>{let l=()=>{let e=document.getElementById("headerButtonsRegionId").children;e.length>=7&&(document.getElementById("owaMeetNowButton_container").style.display=hideTopIcons?"none":"block",document.getElementById("skype_container").style.display=hideTopIcons?"none":"block",document.getElementById("owaNoteFeedButton_container").style.display=hideTopIcons?"none":"block",clearInterval(i))},i=setInterval(l,e)},cleanMailPub=(e=100)=>{let l=0,i=()=>{let e=document.querySelector(".cJ3F3");e&&(e.style.display="none",clearInterval(t)),l>20&&clearInterval(t),l++},t=setInterval(i,e)},rootFolder=()=>{document.querySelector(".wk4Sg").addEventListener("click",function(){cleanMailPub()})},checkAll=(e=100)=>{let l=()=>{let e=document.querySelector(".rk2CU");e&&(checkAllVisible?e.style.visibility="visible":e.style.visibility="hidden",clearInterval(i))},i=setInterval(l,e)},selectAll=(e=150)=>{let l=()=>{let e=document.querySelector(".rk2CU"),l=document.querySelectorAll(".d1dnN");e&&l&&(l.forEach(e=>{e.addEventListener("click",()=>{"true"===e.getAttribute("aria-checked")&&(setTimeout(alignFolderTitle,100),setTimeout(mailCalculator,300))})}),e.addEventListener("click",()=>{"true"===e.getAttribute("aria-checked")&&(setTimeout(alignFolderTitle,100),setTimeout(mailCalculator,300))}),clearInterval(i))},i=setInterval(l,e)},addButtonClickListeners=(e=150)=>{let l=()=>{let e=document.querySelectorAll(".C2IG3");e&&(e.forEach(e=>{e.addEventListener("click",()=>{setTimeout(checkAll,100),setTimeout(selectAll,100),setTimeout(alignFolderTitle,100),setTimeout(mailCalculator,300)})}),clearInterval(i))},i=setInterval(l,e)};